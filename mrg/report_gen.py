# -*- coding: utf-8 -*-
"""
Report Generator

Create HTML report from Model Run results

Created on Fri Mar 11 15:15:15 2016

@author: sjsmith

(c) The Haskell Company
"""
# Module imports
import os

# Member imports
from jinja2 import Environment, FileSystemLoader
from datetime import datetime


haskell_logo = '<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="368px" height="90px" viewBox="0 0 450 110" version="1.1" xmlns="http://www.w3.org/2000/svg"><path fill="#ffffff" d=" M 0.00 0.00 L 55.26 0.00 C 46.32 9.44 36.84 18.35 27.87 27.77 C 18.41 36.75 9.58 46.38 0.00 55.23 L 0.00 0.00 Z"/><path fill="#0169a9" d=" M 55.26 0.00 L 55.65 0.00 C 63.88 9.92 73.93 18.18 82.42 27.88 C 78.00 28.04 73.59 28.05 69.17 28.11 C 69.13 35.81 69.30 43.52 69.09 51.22 C 64.61 51.37 60.13 51.36 55.65 51.26 C 55.51 43.56 55.58 35.87 55.65 28.17 C 46.39 27.77 37.12 28.39 27.87 27.77 C 36.84 18.35 46.32 9.44 55.26 0.00 Z"/><path fill="#ffffff" d=" M 55.65 0.00 L 450.00 0.00 L 450.00 63.00 C 443.28 62.99 436.56 63.01 429.84 62.98 C 429.77 52.67 429.80 42.35 429.83 32.03 C 424.51 31.96 419.18 31.99 413.86 32.01 C 413.89 47.22 413.62 62.45 414.00 77.66 C 426.00 77.60 438.00 77.60 450.00 77.65 L 450.00 110.00 L 55.70 110.00 C 64.45 100.90 73.73 92.31 82.28 83.03 C 77.91 82.86 73.55 82.91 69.19 82.86 C 69.11 74.92 69.31 66.99 69.09 59.05 C 64.61 58.88 60.14 58.89 55.67 58.96 C 55.49 66.91 55.60 74.85 55.64 82.80 C 46.56 83.15 37.46 82.62 28.39 83.11 C 36.52 92.57 46.12 100.67 54.42 110.00 L 0.00 110.00 L 0.00 55.64 C 9.92 64.23 18.56 74.20 28.12 83.20 C 28.37 75.18 28.17 67.15 28.22 59.13 C 37.29 58.97 46.37 59.13 55.44 59.07 C 55.48 56.47 55.44 53.87 55.31 51.28 C 46.29 51.29 37.26 51.53 28.25 51.17 C 28.05 43.37 28.62 35.55 27.87 27.77 C 37.12 28.39 46.39 27.77 55.65 28.17 C 55.58 35.87 55.51 43.56 55.65 51.26 C 60.13 51.36 64.61 51.37 69.09 51.22 C 69.30 43.52 69.13 35.81 69.17 28.11 C 73.59 28.05 78.00 28.04 82.42 27.88 C 73.93 18.18 63.88 9.92 55.65 0.00 Z"/><path fill="#0169a9" d=" M 0.00 55.23 C 9.58 46.38 18.41 36.75 27.87 27.77 C 28.62 35.55 28.05 43.37 28.25 51.17 C 37.26 51.53 46.29 51.29 55.31 51.28 C 55.44 53.87 55.48 56.47 55.44 59.07 C 46.37 59.13 37.29 58.97 28.22 59.13 C 28.17 67.15 28.37 75.18 28.12 83.20 C 18.56 74.20 9.92 64.23 0.00 55.64 L 0.00 55.23 Z"/><path fill="#0169a9" d=" M 83.09 28.53 C 92.45 37.05 100.99 46.45 110.15 55.20 C 101.30 64.42 92.28 73.51 83.03 82.31 C 82.91 64.39 82.80 46.45 83.09 28.53 Z"/><path fill="#000000" d=" M 236.15 37.16 C 239.77 32.81 245.57 31.37 250.98 30.98 C 255.87 30.99 260.60 32.55 265.10 34.35 C 263.81 38.29 262.06 42.06 260.79 46.01 C 257.16 44.33 253.05 42.26 249.05 44.06 C 249.02 44.80 248.94 46.26 248.90 47.00 C 253.89 49.12 259.99 48.92 264.06 52.94 C 268.13 56.85 268.72 63.35 266.37 68.33 C 264.49 73.28 259.65 76.45 254.71 77.78 C 246.51 79.43 237.76 78.08 230.47 73.97 C 232.03 69.68 233.91 65.51 235.33 61.17 C 239.11 63.52 243.15 66.41 247.84 65.94 C 249.91 65.66 252.19 62.79 249.64 61.38 C 244.48 60.02 238.22 59.88 234.73 55.21 C 230.41 49.94 231.46 41.84 236.15 37.16 Z"/><path fill="#000000" d=" M 130.00 32.00 C 135.33 32.00 140.67 32.00 146.01 32.00 C 146.03 37.11 146.01 42.22 146.01 47.34 C 149.66 47.43 153.31 47.44 156.97 47.33 C 156.97 42.22 156.94 37.11 156.98 32.00 C 162.32 32.00 167.66 32.00 173.00 32.00 C 172.90 47.23 173.12 62.46 172.89 77.68 C 167.62 77.59 162.36 77.59 157.09 77.69 C 156.85 72.14 157.00 66.57 156.98 61.01 C 153.32 61.00 149.66 61.00 146.01 61.01 C 145.97 66.57 146.11 72.13 145.91 77.69 C 140.64 77.58 135.37 77.58 130.09 77.69 C 129.88 62.46 130.06 47.23 130.00 32.00 Z"/><path fill="#000000" d=" M 193.08 31.99 C 199.33 32.01 205.58 32.00 211.84 32.00 C 216.66 46.49 221.73 60.90 226.69 75.35 C 226.79 75.92 227.00 77.07 227.10 77.64 C 221.62 77.56 216.14 77.76 210.67 77.49 C 210.21 75.63 209.60 73.81 209.10 71.96 C 204.55 72.00 200.00 71.86 195.46 72.12 C 195.05 74.01 194.44 75.85 193.82 77.69 C 188.33 77.61 182.84 77.52 177.35 77.75 C 182.41 62.44 187.83 47.25 193.08 31.99 Z"/><path fill="#000000" d=" M 271.16 32.03 C 276.52 31.96 281.88 32.01 287.24 32.00 C 287.18 47.22 287.54 62.46 287.05 77.68 C 281.78 77.59 276.51 77.60 271.24 77.66 C 271.12 62.45 271.26 47.24 271.16 32.03 Z"/><path fill="#000000" d=" M 302.48 32.39 C 308.58 31.43 315.01 32.29 321.23 32.00 C 316.19 39.40 310.88 46.61 305.81 53.99 C 310.99 61.70 316.14 69.42 321.22 77.19 C 315.19 77.31 309.15 77.40 303.12 77.20 C 301.87 76.30 301.26 74.80 300.35 73.60 C 296.28 67.27 291.90 61.15 287.85 54.81 C 287.84 54.41 287.83 53.60 287.82 53.20 C 292.68 46.25 297.60 39.33 302.48 32.39 Z"/><path fill="#00000" d=" M 326.68 32.00 C 339.45 32.00 352.23 32.00 365.00 32.00 C 365.00 35.73 365.00 39.46 365.00 43.20 C 357.55 43.24 350.09 43.26 342.64 43.17 C 342.60 44.78 342.55 46.40 342.49 48.02 C 349.99 48.07 357.49 48.03 364.99 48.03 C 365.01 52.02 365.01 56.01 365.00 60.00 C 357.51 60.00 350.02 60.00 342.53 60.00 C 342.52 61.99 342.53 63.98 342.56 65.97 C 350.04 65.98 357.52 65.94 365.00 65.99 C 365.00 69.89 365.05 73.79 364.92 77.69 C 352.24 77.57 339.56 77.58 326.88 77.69 C 326.34 62.48 326.73 47.23 326.68 32.00 Z"/><path fill="#000000" d=" M 371.24 32.05 C 376.53 31.94 381.83 32.02 387.13 32.00 C 387.20 42.32 387.18 52.65 387.13 62.97 C 394.08 63.03 401.04 62.99 408.00 63.00 C 407.98 67.90 408.08 72.80 407.92 77.69 C 395.72 77.55 383.51 77.63 371.30 77.65 C 371.25 62.45 371.36 47.25 371.24 32.05 Z"/><path fill="#000000" d=" M 413.86 32.01 C 419.18 31.99 424.51 31.96 429.83 32.03 C 429.80 42.35 429.77 52.67 429.84 62.98 C 436.56 63.01 443.28 62.99 450.00 63.00 L 450.00 77.65 C 438.00 77.60 426.00 77.60 414.00 77.66 C 413.62 62.45 413.89 47.22 413.86 32.01 Z"/><path fill="#ffffff" d=" M 198.59 61.35 C 199.70 55.38 200.27 49.18 202.56 43.52 C 203.94 49.43 205.36 55.33 206.28 61.33 C 203.72 61.41 201.15 61.41 198.59 61.35 Z"/><path fill="#0169a9" d=" M 55.67 58.96 C 60.14 58.89 64.61 58.88 69.09 59.05 C 69.31 66.99 69.11 74.92 69.19 82.86 C 73.55 82.91 77.91 82.86 82.28 83.03 C 73.73 92.31 64.45 100.90 55.70 110.00 L 54.42 110.00 C 46.12 100.67 36.52 92.57 28.39 83.11 C 37.46 82.62 46.56 83.15 55.64 82.80 C 55.60 74.85 55.49 66.91 55.67 58.96 Z"/></svg>'
haskell_widget = '<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="40px" height="40px" viewBox="0 0 250 250" version="1.1" xmlns="http://www.w3.org/2000/svg"><path fill="#ffffff" d=" M 0.00 0.00 L 124.94 0.00 C 83.34 41.64 41.54 83.08 0.00 124.78 L 0.00 0.00 Z"/><path fill="#075e93" d=" M 124.94 0.00 L 125.17 0.00 C 146.09 20.78 166.94 41.64 187.72 62.55 C 177.43 62.51 167.13 62.53 156.84 62.53 C 156.81 80.36 156.85 98.19 156.82 116.02 C 146.42 116.09 136.03 116.04 125.63 116.05 C 125.65 121.90 125.63 127.75 125.66 133.61 C 104.94 133.64 84.22 133.59 63.51 133.62 C 63.48 151.38 63.58 169.14 63.46 186.89 C 84.24 187.02 105.03 186.90 125.82 186.95 C 125.75 169.18 125.78 151.41 125.81 133.64 C 136.16 133.59 146.51 133.62 156.85 133.62 C 156.78 151.38 156.86 169.14 156.82 186.90 C 164.89 187.01 172.97 186.91 181.04 187.01 C 183.30 187.02 185.72 186.44 187.72 187.80 C 166.64 208.27 146.13 229.34 125.22 250.00 L 124.94 250.00 C 83.26 208.41 41.68 166.71 0.00 125.12 L 0.00 124.78 C 41.54 83.08 83.34 41.64 124.94 0.00 Z"/><path fill="#ffffff" d=" M 125.17 0.00 L 250.00 0.00 L 250.00 124.95 C 229.38 104.15 208.50 83.60 187.96 62.73 C 187.90 103.49 187.93 144.25 187.94 185.01 C 187.90 185.74 187.80 187.21 187.76 187.95 C 189.86 185.02 192.63 182.70 195.13 180.14 C 213.40 161.81 231.78 143.58 250.00 125.20 L 250.00 250.00 L 125.22 250.00 C 146.13 229.34 166.64 208.27 187.72 187.80 C 185.72 186.44 183.30 187.02 181.04 187.01 C 172.97 186.91 164.89 187.01 156.82 186.90 C 156.86 169.14 156.78 151.38 156.85 133.62 C 146.51 133.62 136.16 133.59 125.81 133.64 C 125.78 151.41 125.75 169.18 125.82 186.95 C 105.03 186.90 84.24 187.02 63.46 186.89 C 63.58 169.14 63.48 151.38 63.51 133.62 C 84.22 133.59 104.94 133.64 125.66 133.61 C 125.63 127.75 125.65 121.90 125.63 116.05 C 136.03 116.04 146.42 116.09 156.82 116.02 C 156.85 98.19 156.81 80.36 156.84 62.53 C 167.13 62.53 177.43 62.51 187.72 62.55 C 166.94 41.64 146.09 20.78 125.17 0.00 Z"/><path fill="#ffffff" d=" M 63.55 62.54 C 84.30 62.51 105.04 62.53 125.79 62.53 C 125.68 80.36 125.96 98.20 125.66 116.03 C 104.93 115.82 84.20 116.04 63.47 115.91 C 63.59 98.12 63.43 80.33 63.55 62.54 Z"/><path fill="#075e93" d=" M 187.96 62.73 C 208.50 83.60 229.38 104.15 250.00 124.95 L 250.00 125.20 C 231.78 143.58 213.40 161.81 195.13 180.14 C 192.63 182.70 189.86 185.02 187.76 187.95 C 187.80 187.21 187.90 185.74 187.94 185.01 C 187.93 144.25 187.90 103.49 187.96 62.73 Z"/><path fill="#ffffff" d=" M 0.00 125.12 C 41.68 166.71 83.26 208.41 124.94 250.00 L 0.00 250.00 L 0.00 125.12 Z"/></svg>'

def generate(params,
             report_fn='report.html',
             template_fn='template.html'):
    '''
    Load the jinja2 template, render and write the report file.
    '''
    template_path = os.getcwd()
    template_path = template_path + r'\html'
    env = Environment(loader=FileSystemLoader(template_path))
    template = env.get_template(template_fn)

    with open(report_fn, 'w') as file:
        file.write(template.render(params))


def define_params(report_title=None,
                  user=None):
    if report_title is None:
        report_title = "Haskell Simulation Results"
    if user is None:
        user = os.getlogin()


    params = {'figs': [],
              'page_title': report_title,
              'report_time': datetime.now().strftime('%a %b %d, %Y at %X'),
              'user': user,
              'logo': haskell_logo,
              'widget': haskell_widget}
    return params

if __name__ == '__main__':
    pass